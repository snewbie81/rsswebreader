<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Modern RSS Web Reader with full-text extraction">
    <meta name="theme-color" content="#1a73e8">
    <title>RSS Web Reader</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="manifest" href="manifest.json">
    <link rel="icon" type="image/png" href="icon-192.png">
</head>
<body>
    <div class="app-container">
        <button id="floatingMenuToggle" class="floating-menu-toggle" title="Toggle Sidebar" style="display: none;">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <line x1="3" y1="12" x2="21" y2="12"></line>
                <line x1="3" y1="6" x2="21" y2="6"></line>
                <line x1="3" y1="18" x2="21" y2="18"></line>
            </svg>
        </button>
        <div class="main-content">
            <aside class="sidebar">
                <div class="sidebar-header">
                    <div class="sidebar-logo">
                        <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="11" cy="11" r="8"></circle>
                            <path d="m21 21-4.35-4.35"></path>
                        </svg>
                        <span>RSS Reader</span>
                    </div>
                    <button id="sidebarToggle" class="btn-icon-compact" title="Toggle Sidebar">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <line x1="3" y1="12" x2="21" y2="12"></line>
                            <line x1="3" y1="6" x2="21" y2="6"></line>
                            <line x1="3" y1="18" x2="21" y2="18"></line>
                        </svg>
                    </button>
                </div>

                <div class="sidebar-user-section">
                    <button id="loginBtn" class="btn-compact btn-primary" title="Login/Register">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                            <circle cx="12" cy="7" r="4"></circle>
                        </svg>
                        <span>Login</span>
                    </button>
                    <div id="userInfo" class="user-info-compact" style="display: none;">
                        <div class="user-avatar-compact">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                                <circle cx="12" cy="7" r="4"></circle>
                            </svg>
                        </div>
                        <span id="userEmail" class="user-email-compact"></span>
                        <button id="logoutBtn" class="btn-icon-compact" title="Logout">
                            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
                                <polyline points="16 17 21 12 16 7"></polyline>
                                <line x1="21" y1="12" x2="9" y2="12"></line>
                            </svg>
                        </button>
                    </div>
                </div>

                <div class="feeds-section">
                    <div class="feeds-header">
                        <h2>Feeds</h2>
                        <button id="addFeedBtn" class="btn-icon-compact" title="Add RSS Feed">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <line x1="12" y1="5" x2="12" y2="19"></line>
                                <line x1="5" y1="12" x2="19" y2="12"></line>
                            </svg>
                        </button>
                    </div>
                    <div id="feedsList" class="feeds-list">
                        <p class="empty-state">No feeds added yet. Click + to get started!</p>
                    </div>
                </div>

                <div class="sidebar-footer">
                    <div class="footer-actions">
                        <button id="addGroupBtn" class="btn-icon-compact" title="Add Group">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"></path>
                            </svg>
                        </button>
                        <button id="syncAllBtn" class="btn-icon-compact" title="Sync All Feeds">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <polyline points="23 4 23 10 17 10"></polyline>
                                <polyline points="1 20 1 14 7 14"></polyline>
                                <path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"></path>
                            </svg>
                        </button>
                        <button id="importOpmlBtn" class="btn-icon-compact" title="Import OPML">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                                <polyline points="7 10 12 15 17 10"></polyline>
                                <line x1="12" y1="15" x2="12" y2="3"></line>
                            </svg>
                        </button>
                        <button id="exportOpmlBtn" class="btn-icon-compact" title="Export OPML">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                                <polyline points="17 8 12 3 7 8"></polyline>
                                <line x1="12" y1="3" x2="12" y2="15"></line>
                            </svg>
                        </button>
                        <button id="settingsToggle" class="btn-icon-compact" title="Settings">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <circle cx="12" cy="12" r="3"></circle>
                                <path d="M12 1v6m0 6v6m7.07-12.07l-4.24 4.24m-5.66 0L4.93 4.93m14.14 14.14l-4.24-4.24m-5.66 0l-4.24 4.24"></path>
                            </svg>
                        </button>
                    </div>
                    <div id="settingsPanel" class="settings-panel" style="display: none;">
                        <label class="toggle-container-compact">
                            <input type="checkbox" id="darkModeToggle">
                            <span class="toggle-label-compact">AMOLED Mode</span>
                        </label>
                        <label class="toggle-container-compact">
                            <input type="checkbox" id="hideReadToggle">
                            <span class="toggle-label-compact">Hide Read</span>
                        </label>
                        <div class="content-source-selector-compact">
                            <label class="toggle-label-compact">Content:</label>
                            <select id="contentSourceSelect" class="input-field-compact">
                                <option value="feed">Feed</option>
                                <option value="webpage">Webpage</option>
                                <option value="inline">Inline</option>
                            </select>
                        </div>
                    </div>
                </div>
            </aside>

            <div class="articles-panel">
                <div class="articles-header">
                    <h2 id="articlesPanelTitle">Select a feed</h2>
                </div>
                <div id="articlesList" class="articles-list-panel">
                    <div class="welcome-message-compact">
                        <p>Select a feed to view articles</p>
                    </div>
                </div>
            </div>

            <div class="content-panel">
                <div id="contentViewer" class="content-viewer">
                    <div class="no-selection">
                        <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                            <polyline points="14 2 14 8 20 8"></polyline>
                            <line x1="16" y1="13" x2="8" y2="13"></line>
                            <line x1="16" y1="17" x2="8" y2="17"></line>
                            <polyline points="10 9 9 9 8 9"></polyline>
                        </svg>
                        <p>No selection</p>
                        <span>Select an article to read</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Add Feed Modal -->
    <div id="addFeedModal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Add RSS Feed</h3>
                <button class="btn-close" onclick="closeModal('addFeedModal')">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="18" y1="6" x2="6" y2="18"></line>
                        <line x1="6" y1="6" x2="18" y2="18"></line>
                    </svg>
                </button>
            </div>
            <div class="modal-body">
                <input type="url" id="feedUrlInput" placeholder="Enter RSS feed URL" class="input-field">
                <p class="help-text">Example: https://example.com/feed.xml</p>
                <select id="feedGroupSelect" class="input-field">
                    <option value="">No Group</option>
                </select>
                <p class="help-text">Optional: Select a group for this feed</p>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('addFeedModal')">Cancel</button>
                <button class="btn btn-primary" id="confirmAddFeedBtn">Add Feed</button>
            </div>
        </div>
    </div>

    <!-- Add Group Modal -->
    <div id="addGroupModal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Add Group</h3>
                <button class="btn-close" onclick="closeModal('addGroupModal')">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="18" y1="6" x2="6" y2="18"></line>
                        <line x1="6" y1="6" x2="18" y2="18"></line>
                    </svg>
                </button>
            </div>
            <div class="modal-body">
                <input type="text" id="groupNameInput" placeholder="Enter group name" class="input-field">
                <p class="help-text">Example: Tech News, Sports, Blogs</p>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('addGroupModal')">Cancel</button>
                <button class="btn btn-primary" id="confirmAddGroupBtn">Add Group</button>
            </div>
        </div>
    </div>

    <!-- Import OPML Modal -->
    <div id="importOpmlModal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Import OPML</h3>
                <button class="btn-close" onclick="closeModal('importOpmlModal')">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="18" y1="6" x2="6" y2="18"></line>
                        <line x1="6" y1="6" x2="18" y2="18"></line>
                    </svg>
                </button>
            </div>
            <div class="modal-body">
                <input type="file" id="opmlFileInput" accept=".opml,.xml" class="input-field">
                <p class="help-text">Select an OPML file to import your feeds</p>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('importOpmlModal')">Cancel</button>
                <button class="btn btn-primary" id="confirmImportOpmlBtn">Import</button>
            </div>
        </div>
    </div>

    <input type="file" id="hiddenOpmlInput" accept=".opml,.xml" style="display: none;">

    <!-- Login Modal -->
    <div id="loginModal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Login / Register</h3>
                <button class="btn-close" onclick="closeModal('loginModal')">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="18" y1="6" x2="6" y2="18"></line>
                        <line x1="6" y1="6" x2="18" y2="18"></line>
                    </svg>
                </button>
            </div>
            <div class="modal-body">
                <input type="email" id="loginEmailInput" placeholder="Enter your email" class="input-field">
                <p class="help-text">Enter your email to sync your feeds across devices</p>
                <input type="password" id="loginPasswordInput" placeholder="Enter your password" class="input-field" style="margin-top: 1rem;">
                <p class="help-text">Password (min 6 characters)</p>
                <div id="googleSignInContainer" style="margin-top: 1.5rem; text-align: center; border-top: 1px solid #e0e0e0; padding-top: 1.5rem;">
                    <button class="btn btn-secondary" id="googleSignInBtn" style="width: 100%; display: flex; align-items: center; justify-content: center; gap: 0.5rem;">
                        <svg width="18" height="18" viewBox="0 0 24 24">
                            <path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/>
                            <path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/>
                            <path fill="#FBBC05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/>
                            <path fill="#EA4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/>
                        </svg>
                        <span>Sign in with Google</span>
                    </button>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('loginModal')">Cancel</button>
                <button class="btn btn-primary" id="confirmLoginBtn">Login</button>
                <button class="btn btn-secondary" id="confirmRegisterBtn">Register</button>
            </div>
        </div>
    </div>

    <!-- Supabase SDK -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="supabase-config.js"></script>
    <script src="app.js"></script>
</body>
</html>
